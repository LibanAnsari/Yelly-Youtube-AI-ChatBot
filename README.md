## Yelly — YouTube AI ChatBot (Streamlit + LangChain + Gemini)

Chat with any YouTube video using its transcript. Paste a YouTube link, Yelly fetches the transcript (EN), builds a FAISS vector index with Gemini embeddings, and answers your questions using Gemini via LangChain. This is a RAG (Retrieval-Augmented Generation) workflow that retrieves relevant transcript chunks and generates grounded answers.

---

## Features

- Streamlit UI with chat experience and history
- One-click Google API key validation inside the app
- Auto transcript fetch (english) via `youtube-transcript-api`
- Chunking + FAISS vector store using Gemini Embeddings
- MMR retriever for focused, diverse context
- Retrieval-Augmented Generation (RAG): relevant transcript chunks are retrieved from FAISS and injected into the Gemini prompt for grounded answers
- Answers generated by Gemini (gemini-2.5-flash) through LangChain

---

## Tech stack

- Streamlit, Python 3.11+ recommended
- LangChain (core, community), FAISS, jq-backed JSONLoader
- Google Generative AI: `google-generativeai`, `langchain-google-genai`
- youtube-transcript-api, requests, beautifulsoup4

---

## Project structure

```
src/
	app.py                   # Streamlit app
utils/
	augmentation.py          # Prompt + helpers for formatting docs/history
	generation.py            # LLM chain wiring (Gemini, retriever, parser)
	indexing.py              # JSON loading, splitting, FAISS build
	retrieval.py             # Load FAISS + retriever helpers (MMR, MultiQuery)
	yt_utils.py              # Transcript + video info
data/
	transcripts.json         # Cached transcript for current video
	faiss_index/             # Saved FAISS index (index.faiss + index.pkl)
requirements.txt
```

---

## Prerequisites

- Python 3.11+ on Windows
- A Google API Key from Google AI Studio
	- https://aistudio.google.com/apikey

Optional but supported: put `GOOGLE_API_KEY` in a `.env` file. The app also lets you paste the key in the sidebar and keeps it for the session only.

---

## Quickstart (Windows PowerShell)

```powershell
# 1) Create and activate a virtual environment
python -m venv .venv
.\.venv\Scripts\Activate

# 2) Install dependencies
pip install --upgrade pip
pip install -r requirements.txt

# 3) Run the app
streamlit run src/app.py
```

When the app opens:
1. Paste your Google API key in the sidebar to validate it.
2. Paste a YouTube link (EN videos supported).
3. Ask questions in the chat box.

---

## How it works — RAG (Retrieval-Augmented Generation)

1. Transcript: `youtube-transcript-api` fetches the transcript; details saved to `data/transcripts.json`.
2. Indexing: `JSONLoader` (+ `jq`) loads JSON; `RecursiveCharacterTextSplitter` chunks text; `HuggingFaceEmbeddings` embeds; FAISS saves to `data/faiss_index`.
3. Retrieval: MMR retriever selects diverse, relevant chunks.
4. Generation: `ChatGoogleGenerativeAI` (model: `gemini-2.5-flash`) answers using a friendly prompt; responses stream to the UI.

---

## Configuration

- API Key
	- In-app: enter key in the sidebar.
	- Or set env var before launching:
		```powershell
		$env:GOOGLE_API_KEY = "YOUR_KEY_HERE"
		streamlit run src/app.py
		```
- Model names
	- Change LLM in `utils/generation.py` (default: `gemini-2.5-flash`).
	- Change embedding model in `utils/indexing.py` and `utils/retrieval.py` (default: `models/gemini-embedding-004`).
- Chunking and retrieval
	- Tune chunk size/overlap in `utils/indexing.py`.
	- Switch between MMR and MultiQuery in `utils/generation.py`.

---

## Troubleshooting

- Invalid API key
	- Ensure the key is copied correctly from AI Studio; try setting `$env:GOOGLE_API_KEY` and restart the app.

- IPBlocked YouTubeTranscriptApi
	- Too many requests can get IPBlocked by YouTube. Wait for some days for it to restore or use [proxies](https://github.com/jdepoix/youtube-transcript-api?tab=readme-ov-file#working-around-ip-bans-requestblocked-or-ipblocked-exception).

- No transcript found
	- Some videos disable transcripts or lack EN captions. Try a different video or language.

- FAISS errors on Windows
	- Use `faiss-cpu` (already in requirements). If issues persist, try a clean venv or use WSL.

- jq/JSONLoader issues
	- The LangChain `JSONLoader` uses `jq_schema`. Install the `jq` Python package (included) and ensure dependencies installed successfully.

- Network / 403 / 429 errors fetching titles or transcripts
	- YouTube may throttle requests. Retry later; ensure stable network.

---

## Notes and limitations

- English transcripts only (current implementation).
- Chat history is truncated to the last 20 messages for performance.
- The app stores transcripts and FAISS index in the local `data/` folder.

---

## Acknowledgements

- Google Gemini via `google-generativeai` and `langchain-google-genai`
- LangChain community, FAISS, Streamlit
- youtube-transcript-api
